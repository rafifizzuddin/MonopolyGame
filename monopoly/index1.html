<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Monopoli Web</title>
  <style>
    body {
      display: flex;
      font-family: sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
    }

    #game-board {
      display: grid;
      grid-template-columns: repeat(11, 60px);
      grid-template-rows: repeat(11, 60px);
      gap: 2px;
      width: 660px;
      height: 660px;
      background: white;
      border: 4px solid #333;
      margin: 10px;
    }

    .tile {
      border: 1px solid #ccc;
      background: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 10px;
      text-align: center;
      padding: 4px;
      box-sizing: border-box;
    }

    .start-tile {
      background-color: #d4fcd4;
      font-weight: bold;
    }

    #sidebar {
      padding: 20px;
      background: #fafafa;
      width: 300px;
    }

    #log {
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
      font-size: 14px;
      background: #eee;
      padding: 10px;
    }

    #players-info {
      margin-bottom: 10px;
    }

    .player-token {
      font-weight: bold;
      color: red;
    }

    #setup {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="game-board"></div>

  <div id="sidebar">
    <div id="setup">
      <h3>Atur Jumlah Pemain</h3>
      <label for="player-count">Jumlah Pemain: </label>
      <input type="number" id="player-count" value="2" min="2" max="6" />
      <button id="start-game-btn">Mulai Game</button>
    </div>

    <h2>Pemain</h2>
    <div id="players-info"></div>
    <button id="roll-dice-btn" disabled>üé≤ Lempar Dadu</button>
    <div id="dice-result"></div>
    <div id="log"></div>
  </div>

  <script>
    const gameBoard = document.getElementById('game-board');
    const playersInfo = document.getElementById('players-info');
    const rollDiceBtn = document.getElementById('roll-dice-btn');
    const diceResult = document.getElementById('dice-result');
    const logBox = document.getElementById('log');

    const playerCountInput = document.getElementById('player-count');
    const startGameBtn = document.getElementById('start-game-btn');

    const tiles = [];
    let players = [];
    let currentPlayer = 0;

    function log(text) {
      const p = document.createElement('div');
      p.textContent = text;
      logBox.prepend(p);
    }

    function updatePlayersInfo() {
      playersInfo.innerHTML = '';
      players.forEach((player, index) => {
        const div = document.createElement('div');
        div.innerHTML = `üë§ ${player.name} - üí∞ $${player.money} - üìç Posisi ${player.position}`;
        playersInfo.appendChild(div);
      });
    }

    function createBoard() {
      const size = 11;
      const board = [];

      for (let i = 0; i < size * size; i++) {
        const div = document.createElement('div');
        div.classList.add('tile');
        board.push(div);
        gameBoard.appendChild(div);
      }

      const order = [];

      for (let col = size - 1; col >= 0; col--) {
        order.push((size - 1) * size + col);
      }

      for (let row = size - 2; row >= 1; row--) {
        order.push(row * size);
      }

      for (let col = 0; col < size; col++) {
        order.push(col);
      }

      for (let row = 1; row < size - 1; row++) {
        order.push(row * size + (size - 1));
      }

      for (let i = 0; i < order.length; i++) {
        const idx = order[i];
        const tile = board[idx];
        if (i === 0) {
          tile.classList.add('start-tile');
          tile.textContent = 'Start';
        } else {
          tile.textContent = 'Petak ' + i;
        }
        tiles.push({ index: i, element: tile });
      }
    }

    function updateBoard() {
      tiles.forEach(t => {
        t.element.innerHTML = (t.index === 0) ? 'Start' : 'Petak ' + t.index;
      });

      players.forEach(player => {
        const tile = tiles[player.position];
        tile.element.innerHTML += `<div class="player-token">${player.name}</div>`;
      });
    }

    function rollDice() {
      const roll = Math.floor(Math.random() * 6) + 1;
      diceResult.textContent = `üé≤ Dadu: ${roll}`;

      const player = players[currentPlayer];
      player.position = (player.position + roll) % tiles.length;

      log(`${player.name} melempar dadu dan jalan ${roll} langkah ke petak ${player.position}`);
      updatePlayersInfo();
      updateBoard();

      currentPlayer = (currentPlayer + 1) % players.length;
    }

    function startGame() {
      const count = parseInt(playerCountInput.value);
      if (count < 2 || count > 6) {
        alert('Jumlah pemain minimal 2 dan maksimal 6.');
        return;
      }

      players = [];
      for (let i = 1; i <= count; i++) {
        players.push({ name: 'P' + i, position: 0, money: 1500 });
      }

      currentPlayer = 0;
      updatePlayersInfo();
      updateBoard();
      rollDiceBtn.disabled = false;
      log(`Game dimulai dengan ${count} pemain.`);
    }

    rollDiceBtn.addEventListener('click', rollDice);
    startGameBtn.addEventListener('click', startGame);

    createBoard();
  </script>
</body>
</html>
